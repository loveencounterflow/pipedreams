{
  "version": 3,
  "file": "collect.test.js",
  "sourceRoot": "../..",
  "sources": [
    "src/tests/collect.test.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n\n'use strict'\n\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'PIPEDREAMS/TESTS/SELECT'\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\ninfo                      = CND.get_logger 'info',      badge\nurge                      = CND.get_logger 'urge',      badge\nhelp                      = CND.get_logger 'help',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\ntest                      = require 'guy-test'\njr                        = JSON.stringify\n#...........................................................................................................\nL                         = require '../select'\nPD                        = require '../..'\n{ $\n  $async\n  select\n  stamp }                 = PD\n\n#-----------------------------------------------------------------------------------------------------------\nf = ( T, method, probe, matcher, errmsg_pattern ) ->\n  errmsg_pattern = if errmsg_pattern? then ( new RegExp errmsg_pattern ) else null\n  try\n    result = await method()\n  catch error\n    # throw error\n    if errmsg_pattern? and ( errmsg_pattern.test error.message )\n      echo CND.green jr [ probe, null, errmsg_pattern.source, ]\n      T.ok true\n    else\n      echo CND.indigo \"unexpected exception\", ( jr [ probe, null, error.message, ] )\n      T.fail \"unexpected exception for probe #{jr probe}:\\n#{error.message}\"\n      # return reject \"failed with #{error.message}\"\n    return null\n  if CND.equals result, matcher\n    T.ok true\n    echo CND.lime jr [ probe, result, null, ]\n  else\n    T.fail \"neq: result #{jr result}, matcher #{jr matcher}\"\n    echo CND.red jr [ probe, result, null, ]\n  # return resolve result\n  return result\n\n#-----------------------------------------------------------------------------------------------------------\n$as_event = -> $ ( x, send ) ->\n  type = CND.type_of x\n  return send PD.new_single_event 'number', x  if ( type is 'number' )\n  return send PD.new_system_event x[ 1 .. ]    if ( type is 'text' ) and ( x.startsWith '~' )\n  return send PD.new_single_event 'text', x    if ( type is 'text' )\n  throw new Error \"unhandled type #{rpr type}\"\n\n#-----------------------------------------------------------------------------------------------------------\n@[ \"$collect 1\" ] = ( T, done ) ->\n  probes_and_matchers = [\n    [[[],[1,2,3,4,5,6]],[{\"key\":\"^collection\",\"value\":[{\"key\":\"^number\",\"value\":1},{\"key\":\"^number\",\"value\":2},{\"key\":\"^number\",\"value\":3},{\"key\":\"^number\",\"value\":4},{\"key\":\"^number\",\"value\":5},{\"key\":\"^number\",\"value\":6}]}],null]\n    [[[{\"value\":true}],[1,2,3,4,5,6]],[{\"key\":\"^collection\",\"value\":[1,2,3,4,5,6]}],null]\n    [[[{\"value\":true}],[1,2,3,\"~collect\",4,5,6]],[{\"key\":\"^collection\",\"value\":[1,2,3]},{\"key\":\"^collection\",\"value\":[4,5,6]}],null]\n    ]\n  #.........................................................................................................\n  for [ probe, matcher, errmsg_pattern, ] in probes_and_matchers\n    method = ->\n      new Promise ( resolve, reject ) ->\n        R             = []\n        pipeline      = []\n        [ parameters\n          inputs ]    = probe\n        pipeline.push PD.new_value_source inputs\n        pipeline.push $as_event()\n        pipeline.push PD.$watch ( d ) -> whisper jr d\n        pipeline.push PD.$collect parameters...\n        pipeline.push PD.$watch ( d ) -> urge jr d\n        pipeline.push PD.$watch ( d ) -> R.push d unless select d, '~'\n        pipeline.push PD.$drain -> resolve R\n        PD.pull pipeline...\n    await f T, method, probe, matcher, errmsg_pattern\n  done()\n  return null\n\n\n\n############################################################################################################\nunless module.parent?\n  # include = [\n  #   \"async 1\"\n  #   \"async 1 paramap\"\n  #   \"async 2\"\n  #   ]\n  # @_prune()\n  test @\n\n\n\n"
  ]
}