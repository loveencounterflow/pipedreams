{
  "version": 3,
  "file": "xemitter.js",
  "sourceRoot": "..",
  "sources": [
    "src/xemitter.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'PIPEDREAMS/XEMITTER'\ndebug                     = CND.get_logger 'debug',     badge\nalert                     = CND.get_logger 'alert',     badge\nwhisper                   = CND.get_logger 'whisper',   badge\nwarn                      = CND.get_logger 'warn',      badge\nhelp                      = CND.get_logger 'help',      badge\nurge                      = CND.get_logger 'urge',      badge\ninfo                      = CND.get_logger 'info',      badge\n#...........................................................................................................\n### https://github.com/sindresorhus/emittery ###\nEmittery                  = require 'emittery'\nPD                        = require '..'\nmisfit                    = Symbol 'misfit'\n\n#-----------------------------------------------------------------------------------------------------------\nprovide_library = ->\n\n  #=========================================================================================================\n  # IMPLEMENTATION DETAILS\n  #---------------------------------------------------------------------------------------------------------\n  @_emitter         = new Emittery()\n  @_has_contractors = {}\n\n  #---------------------------------------------------------------------------------------------------------\n  @_mark_as_primary = ( x ) -> PD.new_system_event 'XEMITTER-preferred', x\n  @_filter_primary  = ( x ) -> PD.select x, '~XEMITTER-preferred'\n  @_get_primary     = ( values ) -> ( values.filter @_filter_primary )[ 0 ]?.value ? misfit\n\n  #---------------------------------------------------------------------------------------------------------\n  @_get_ksl = ( key, self, listener ) ->\n    switch arity = arguments.length\n      when 2 then [ key, self, listener, ] = [ key, null, self,       ]\n      when 3 then [ key, self, listener, ] = [ key, self,  listener,  ]\n      else throw new Error \"µ67348 expected 2 or 3 arguments, got #{arity}\"\n    unless ( CND.isa_text key ) and ( key.length > 0 )\n      throw new Error \"µ67800 expected a non-empty text for key, got #{rpr key}\"\n    return [ key, self, listener, ]\n\n  #---------------------------------------------------------------------------------------------------------\n  @_get_sl = ( self, listener ) ->\n    switch arity = arguments.length\n      when 1 then [ self, listener, ] = [ null, self,       ]\n      when 2 then [ self, listener, ] = [ self,  listener,  ]\n      else throw new Error \"µ68252 expected 1 or 2 arguments, got #{arity}\"\n    return [ self, listener, ]\n\n  #---------------------------------------------------------------------------------------------------------\n  @_get_kd = ( key, d ) ->\n    org_key = key\n    org_d   = d\n    switch arity = arguments.length\n      when 1 then [ key, d, ] = [ key.key, key, ]\n      when 2 then null\n      else throw new Error \"µ69156 expected 1 or 2 arguments, got #{arity}\"\n    throw new Error \"µ69608 expected a key, got #{rpr key} from #{rpr org_key}, #{rpr org_d}\" unless key?\n    return [ key, d, ]\n\n\n  #=========================================================================================================\n  # API / RECEIVING\n  #---------------------------------------------------------------------------------------------------------\n  @contract       = ( key, self, listener ) -> @_contract 'on',     ( @_get_ksl arguments... )...\n  @listen_to      = ( key, self, listener ) -> @_listen_to 'on',    ( @_get_ksl arguments... )...\n  ### These do not currently work for unknown reasons: ###\n  # @contract_once  = ( key, self, listener ) -> @_contract 'once',   ( @_get_ksl arguments... )...\n  # @listen_to_once = ( key, self, listener ) -> @_listen_to 'once',  ( @_get_ksl arguments... )...\n\n  #---------------------------------------------------------------------------------------------------------\n  @_contract = ( method_name, key, self, listener ) ->\n    if @_has_contractors[ key ]\n      throw new Error \"µ68704 key #{rpr key} already has a primary listener\"\n    @_has_contractors[ key ] = yes\n    @_emitter[ method_name ] key, ( d ) =>\n      return @_mark_as_primary await listener.call self, d\n    return listener\n\n  #---------------------------------------------------------------------------------------------------------\n  @_listen_to = ( method_name, key, self, listener ) ->\n    @_emitter[ method_name ] key, ( d ) -> await listener.call self, d\n    return listener\n\n  #---------------------------------------------------------------------------------------------------------\n  @listen_to_all = ( self, listener ) ->\n    [ self, listener, ] = @_get_sl arguments...\n    @_emitter.onAny ( key, d ) -> await listener.call self, key, d\n    return listener\n\n\n  #=========================================================================================================\n  # API / SENDING\n  #---------------------------------------------------------------------------------------------------------\n  @emit = ( key, d ) -> await @_emitter.emit ( @_get_kd arguments... )...\n\n  #---------------------------------------------------------------------------------------------------------\n  @delegate = ( key, d ) ->\n    if ( R = @_get_primary await @emit arguments... ) is misfit\n      throw new Error \"µ83733 no results for #{rpr key.key ? key}\"\n    return R\n\n  #=========================================================================================================\n  #\n  #---------------------------------------------------------------------------------------------------------\n  for name, value of L = @\n    ### TAINT poor man's 'callable' detection ###\n    continue unless CND.isa_function value.bind\n    L[ name ] = value.bind L\n\n\n############################################################################################################\n@new_scope = ->\n  provide_library.apply R = {}\n  return R\n\n"
  ]
}