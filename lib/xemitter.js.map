{
  "version": 3,
  "file": "xemitter.js",
  "sourceRoot": "..",
  "sources": [
    "src/xemitter.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'PIPEDREAMS/XEMITTER'\ndebug                     = CND.get_logger 'debug',     badge\nalert                     = CND.get_logger 'alert',     badge\nwhisper                   = CND.get_logger 'whisper',   badge\nwarn                      = CND.get_logger 'warn',      badge\nhelp                      = CND.get_logger 'help',      badge\nurge                      = CND.get_logger 'urge',      badge\ninfo                      = CND.get_logger 'info',      badge\n#...........................................................................................................\n### https://github.com/sindresorhus/emittery ###\nEmittery                  = require 'emittery'\nPD                        = require '..'\nmisfit                    = Symbol 'misfit'\n\n#-----------------------------------------------------------------------------------------------------------\nprovide_library = ->\n\n  #=========================================================================================================\n  # IMPLEMENTATION DETAILS\n  #---------------------------------------------------------------------------------------------------------\n  @_emitter         = new Emittery()\n  @_has_contractors = {}\n\n  #---------------------------------------------------------------------------------------------------------\n  @_mark_as_primary = ( x ) -> PD.new_system_datom 'XEMITTER-preferred', x\n  @_filter_primary  = ( x ) -> PD.select x, '~XEMITTER-preferred'\n\n  #---------------------------------------------------------------------------------------------------------\n  @_get_primary = ( values ) ->\n    primary_responses = values.filter @_filter_primary\n    return misfit unless primary_responses.length > 0\n    return primary_responses[ 0 ]?.value\n\n  #---------------------------------------------------------------------------------------------------------\n  @_get_ksl = ( key, self, listener ) ->\n    switch arity = arguments.length\n      when 2 then [ key, self, listener, ] = [ key, null, self,       ]\n      when 3 then [ key, self, listener, ] = [ key, self,  listener,  ]\n      else throw new Error \"µ67348 expected 2 or 3 arguments, got #{arity}\"\n    unless ( CND.isa_text key ) and ( key.length > 0 )\n      throw new Error \"µ67800 expected a non-empty text for key, got #{rpr key}\"\n    return [ key, self, listener, ]\n\n  #---------------------------------------------------------------------------------------------------------\n  @_get_sl = ( self, listener ) ->\n    switch arity = arguments.length\n      when 1 then [ self, listener, ] = [ null, self,       ]\n      when 2 then [ self, listener, ] = [ self,  listener,  ]\n      else throw new Error \"µ68252 expected 1 or 2 arguments, got #{arity}\"\n    return [ self, listener, ]\n\n  #---------------------------------------------------------------------------------------------------------\n  @_get_kd = ( key, d ) ->\n    org_key = key\n    org_d   = d\n    switch arity = arguments.length\n      when 1 then [ key, d, ] = [ key.key, key, ]\n      when 2 then null\n      else throw new Error \"µ69156 expected 1 or 2 arguments, got #{arity}\"\n    throw new Error \"µ69608 expected a key, got #{rpr key} from #{rpr org_key}, #{rpr org_d}\" unless key?\n    return [ key, d, ]\n\n\n  #=========================================================================================================\n  # API / RECEIVING\n  #---------------------------------------------------------------------------------------------------------\n  @contract = ( key, self, listener ) ->\n    [ key, self, listener, ]  = @_get_ksl arguments...\n    throw new Error \"µ68704 key #{rpr key} already has a primary listener\" if @_has_contractors[ key ]\n    @_has_contractors[ key ]  = yes\n    return @_emitter.on key, ( d ) => @_mark_as_primary await listener.call self, d\n\n  #---------------------------------------------------------------------------------------------------------\n  @listen_to = ( key, self, listener ) ->\n    [ key, self, listener, ]  = @_get_ksl arguments...\n    return @_emitter.on key, ( d ) -> await listener.call self, d\n\n  #---------------------------------------------------------------------------------------------------------\n  @listen_to_all = ( self, listener ) ->\n    [ self, listener, ]       = @_get_sl arguments...\n    return @_emitter.onAny ( key, d ) -> await listener.call self, key, d\n\n  #=========================================================================================================\n  # API / SENDING\n  #---------------------------------------------------------------------------------------------------------\n  @emit = ( key, d ) -> await @_emitter.emit ( @_get_kd arguments... )...\n\n  #---------------------------------------------------------------------------------------------------------\n  @delegate = ( key, d ) ->\n    if ( R = @_get_primary await @emit arguments... ) is misfit\n      throw new Error \"µ83733 no results for #{rpr key.key ? key}\"\n    return R\n\n\n  #=========================================================================================================\n  #\n  #---------------------------------------------------------------------------------------------------------\n  for name, value of L = @\n    ### TAINT poor man's 'callable' detection ###\n    continue unless CND.isa_function value.bind\n    L[ name ] = value.bind L\n\n\n############################################################################################################\n@new_scope = ->\n  provide_library.apply R = {}\n  return R\n\n"
  ]
}